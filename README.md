# 1. ğŸ“Œ í”„ë¡œì íŠ¸ ëª©í‘œ (Project Objective)

## í•œ ì¤„ ìš”ì•½
**ìœ ì € í–‰ë™ íŒ¨í„´ì˜ ì°¨ì´ê°€ â€˜ë‹¨ê¸° ì „í™˜(ë¹ ë¥¸ ì²« êµ¬ë§¤)â€™ê³¼ â€˜ì¥ê¸° ê°€ì¹˜(LTV/Retention)â€™ ì‚¬ì´ì˜ trade-offë¥¼ ì–´ë–»ê²Œ ë§Œë“¤ì–´ë‚´ëŠ”ê°€?**

---

## ë°°ê²½
ë§ì€ E-commerceì—ì„œ â€œì „í™˜ìœ¨ì„ ì˜¬ë¦¬ë©´ ë§¤ì¶œë„ ê°™ì´ ì˜¤ë¥¸ë‹¤â€ëŠ” ê°€ì •ì´ ìì£¼ ì“°ì´ì§€ë§Œ,  
ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” **ë¹ ë¥¸ ì „í™˜ì„ ë§Œë“œëŠ” í–‰ë™**ê³¼ **ì¥ê¸°ì ìœ¼ë¡œ ë†’ì€ ê°€ì¹˜ë¥¼ ë§Œë“œëŠ” í–‰ë™**ì´ í•­ìƒ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤.  
ë³¸ í”„ë¡œì íŠ¸ëŠ” ì´ **êµ¬ì¡°ì  trade-off**ê°€ ì–´ë–¤ í–‰ë™ íŒ¨í„´ì—ì„œ ë°œìƒí•˜ë©°, ê·¸ ê²°ê³¼ê°€ ì§€í‘œë¡œ ì–´ë–»ê²Œ ë‚˜íƒ€ë‚˜ëŠ”ì§€ë¥¼ **ë°ì´í„°ë¡œ ì„¤ëª…**í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•œë‹¤.

> ì´ í”„ë¡œì íŠ¸ëŠ” â€œì „í™˜ìœ¨ì„ ìµœëŒ€í™”í•˜ëŠ” ë°©ë²•â€ì„ ì œì‹œí•˜ì§€ ì•ŠëŠ”ë‹¤.  
> ëŒ€ì‹  trade-offë¥¼ í•´ì„ì˜ ê¸°ì¤€ ì¶•ìœ¼ë¡œ ë‘ê³ , í–‰ë™ â†’ ì „í™˜ â†’ ì”ì¡´ â†’ LTV â†’ êµ¬ë…(ê²°ê³¼ ì¦ê±°) íë¦„ìœ¼ë¡œ êµ¬ì¡°ë¥¼ ì„¤ëª…í•œë‹¤.

---

## í•µì‹¬ KPI ì •ì˜ (Window ê³ ì •)
- **Short-term Conversion (ë©”ì¸):** ê°€ì… í›„ **14ì¼ ë‚´ ì²« êµ¬ë§¤**
- **ë³´ì¡° KPI:** ê°€ì… í›„ **30ì¼ ë‚´ ì²« êµ¬ë§¤**
- **LTV window:** ê°€ì… í›„ **180ì¼ ëˆ„ì  ë§¤ì¶œ**
- **Subscription:** trade-offì˜ â€œì›ì¸â€ì´ ì•„ë‹ˆë¼ **ê²°ê³¼(outcome evidence)**ë¡œë§Œ ì‚¬ìš©

---

## ì´ í”„ë¡œì íŠ¸ê°€ ë‹µí•˜ë ¤ëŠ” í•µì‹¬ ì§ˆë¬¸
- ì–´ë–¤ í–‰ë™ íŒ¨í„´ì€ **14ì¼ ë‚´ ì²« êµ¬ë§¤(ë‹¨ê¸° ì „í™˜)**ë¥¼ ë¹ ë¥´ê²Œ ë§Œë“¤ì§€ë§Œ, ì™œ **ì¥ê¸° ì”ì¡´/180ì¼ LTV**ëŠ” ë‚®ì•„ì§€ëŠ”ê°€?
- ë°˜ëŒ€ë¡œ, ì´ˆê¸° ì „í™˜ì€ ëŠë¦¬ë”ë¼ë„ **ë” ì˜¤ë˜ ë‚¨ê³ (ì”ì¡´), ë” í° 180ì¼ LTVë¥¼ ë§Œë“œëŠ” íŒ¨í„´**ì€ ë¬´ì—‡ì¸ê°€?
- ì´ trade-offëŠ” â€œí–‰ë™ì˜ ì–‘â€ì´ ì•„ë‹ˆë¼, **í–‰ë™ì˜ êµ¬ì¡°(ì¡°í•©/ë¦¬ë“¬/ì¼ê´€ì„±)** ì°¨ì´ì—ì„œ ë°œìƒí•˜ëŠ”ê°€?

---

## ë¶„ì„ ì ‘ê·¼ (High-level)
ë³¸ í”„ë¡œì íŠ¸ëŠ” ì•„ë˜ íë¦„ìœ¼ë¡œ trade-offë¥¼ ì„¤ëª…í•œë‹¤.
1) **User Behavior:** í–‰ë™ êµ¬ì¡° ê¸°ë°˜ ì„¸ê·¸ë¨¼íŠ¸ ì •ì˜ (ë‹¨ì¼ activation KPIì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ)
2) **Short-term Conversion:** í¼ë„/ì „í™˜ ì†ë„/êµ¬ì¡° ë¹„êµ
3) **Retention / Cohort:** 90ì¼/180ì¼ ì”ì¡´ ë¹„êµ (ì‹œê°„ íš¨ê³¼ í†µì œ)
4) **LTV Distribution:** í‰ê· ì´ ì•„ë‹Œ **ë¶„í¬/ìƒìœ„ ì§‘ì¤‘ë„(tail)** ì¤‘ì‹¬ ë¹„êµ
5) **Subscription:** ê²°ê³¼ ì¦ê±°ë¡œ í™•ì¸ (ì›ì¸ ì¶•ìœ¼ë¡œ ì“°ì§€ ì•ŠìŒ)
6) **Behavior Consistency (í•µì‹¬ ì¶•):** ë°©ë¬¸/êµ¬ë§¤ ë¦¬ë“¬ì˜ â€˜ì¼ê´€ì„±â€™ì´ short-term conversionê³¼ long-term valueì˜ trade-offë¥¼ ì–´ë–»ê²Œ ì„¤ëª…í•˜ëŠ”ê°€?

## 3. ğŸ—‚ ë°ì´í„° ëª¨ë¸ (ERD)

ë³¸ í”„ë¡œì íŠ¸ì˜ Raw ë°ì´í„°ëŠ” ì´ **8ê°œ í…Œì´ë¸”**ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

### âœ… Tables (8)

- **Dimension**
  - `users` : ìœ ì € í”„ë¡œí•„/ì„¸ê·¸ë¨¼íŠ¸
  - `products` : ìƒí’ˆ ë§ˆìŠ¤í„°
  - `promo_calendar` : íšŒì‚¬ ê³µí†µ í”„ë¡œëª¨ì…˜ ìº˜ë¦°ë”

- **Raw Logs (í–‰ë™ ë¡œê·¸)**
  - `sessions` : ë°©ë¬¸/ì„¸ì…˜ ë‹¨ìœ„ ë¡œê·¸
  - `events` : ì„¸ì…˜ ë‚´ ì´ë²¤íŠ¸ ë¡œê·¸ (funnel 5-step)

- **Transaction**
  - `orders` : ì£¼ë¬¸ í—¤ë” (purchase ì´ë²¤íŠ¸ì—ì„œ íŒŒìƒ)
  - `order_items` : ì£¼ë¬¸ ìƒì„¸

- **Business Outcome**
  - `subscriptions` : êµ¬ë…/ë©¤ë²„ì‹­ ê²°ê³¼

### ğŸ”’ Integrity Rules (Frozen Specs)

- Funnel ì´ë²¤íŠ¸ëŠ” **5ë‹¨ê³„ ê³ ì •**: `view â†’ click â†’ add_to_cart â†’ checkout â†’ purchase`
- `order_id`ëŠ” **purchase ì´ë²¤íŠ¸ì—ì„œë§Œ ì¡´ì¬**
- **purchase ì´ë²¤íŠ¸ 1ê±´ = orders 1ê±´** (ì •í•©ì„± ìœ ì§€)
- Raw ë¡œê·¸ ë³´ì¡´ ì›ì¹™: `sessions/events`ëŠ” Rawë¡œ ìœ ì§€í•˜ê³ , revisit/retention/funnel conversion ë“± **íŒŒìƒ ì§€í‘œëŠ” BigQuery Data Mart(SQL)ì—ì„œ ê³„ì‚°**

---

<details>
  <summary><b>ğŸ“Œ (í´ë¦­) Detailed Schema (Columns)</b></summary>

### users
| column | description |
|---|---|
| user_id | PK |
| signup_date | ê°€ì…ì¼ |
| user_type | í–‰ë™ íƒ€ì…(A/B/C/D) |
| device | iOS/Android/Web |
| region | ì§€ì—­ |
| marketing_source | Organic/Paid/Referral |
| anomaly_flag | QAìš© í”Œë˜ê·¸ |

### products
| column | description |
|---|---|
| product_id | PK |
| product_name | ìƒí’ˆëª… |
| category | ì¹´í…Œê³ ë¦¬ |
| brand | ë¸Œëœë“œ |
| price | ê°€ê²© |
| rating_avg | í‰ê·  í‰ì  |
| is_new_arrival | ì‹ ìƒí’ˆ ì—¬ë¶€ |

### promo_calendar
| column | description |
|---|---|
| promo_id | PK |
| promo_name | í”„ë¡œëª¨ì…˜ëª… |
| start_date | ì‹œì‘ì¼ |
| end_date | ì¢…ë£Œì¼ |
| uplift_level | uplift ê°•ë„ ë ˆë²¨ |
| discount_rate | í• ì¸ìœ¨ |

### sessions
| column | description |
|---|---|
| session_id | PK |
| user_id | FK â†’ users.user_id |
| session_start_ts | ì„¸ì…˜ ì‹œì‘ ì‹œê° |
| user_type | í–‰ë™ íƒ€ì… ìŠ¤ëƒ…ìƒ· |
| device | ë””ë°”ì´ìŠ¤ ìŠ¤ëƒ…ìƒ· |
| is_promo | í”„ë¡œëª¨ì…˜ ì—¬ë¶€ |
| discount_rate | ì ìš© í• ì¸ìœ¨ |
| promo_id | FK â†’ promo_calendar.promo_id (í•´ë‹¹ ì‹œ) |

### events
| column | description |
|---|---|
| event_id | PK |
| user_id | FK â†’ users.user_id |
| event_ts | ì´ë²¤íŠ¸ ì‹œê° |
| event_type | view/click/add_to_cart/checkout/purchase |
| session_id | FK â†’ sessions.session_id |
| device | ë””ë°”ì´ìŠ¤ ìŠ¤ëƒ…ìƒ· |
| order_id | purchase ì´ë²¤íŠ¸ì—ì„œë§Œ ì¡´ì¬ |
| product_id | FK â†’ products.product_id |
| is_promo | í”„ë¡œëª¨ì…˜ ì—¬ë¶€ |
| discount_rate | ì ìš© í• ì¸ìœ¨ |
| promo_id | FK â†’ promo_calendar.promo_id (í•´ë‹¹ ì‹œ) |

### orders
| column | description |
|---|---|
| order_id | PK (purchase ì´ë²¤íŠ¸ì™€ 1:1) |
| user_id | FK â†’ users.user_id |
| order_ts | ì£¼ë¬¸ ì‹œê° |
| is_promo | í”„ë¡œëª¨ì…˜ ì—¬ë¶€ |
| discount_rate | ì ìš© í• ì¸ìœ¨ |
| promo_id | FK â†’ promo_calendar.promo_id (í•´ë‹¹ ì‹œ) |

### order_items
| column | description |
|---|---|
| order_item_id | PK |
| order_id | FK â†’ orders.order_id |
| user_id | FK â†’ users.user_id |
| product_id | FK â†’ products.product_id |
| quantity | ìˆ˜ëŸ‰ |
| unit_price | ì •ê°€ |
| is_promo | í”„ë¡œëª¨ì…˜ ì—¬ë¶€ |
| discount_rate | ì ìš© í• ì¸ìœ¨ |
| final_unit_price | í• ì¸ ì ìš© ë‹¨ê°€ |
| line_amount | final_unit_price * quantity |

### subscriptions
| column | description |
|---|---|
| subscription_id | PK (Free í¬í•¨ í•­ìƒ ì¡´ì¬: SUB_{user_id}) |
| user_id | FK â†’ users.user_id |
| plan | Free/Plus/Premium |
| start_date | ì‹œì‘ì¼ |
| end_date | ì¢…ë£Œì¼(ì—†ìœ¼ë©´ null ê°€ëŠ¥) |
| status | Active/Cancelled/Expired ë“± |
| monthly_fee | ì›” ìš”ê¸ˆ |

</details>


# 4. ğŸ›  Synthetic Dataset Generation (Python)

ë³¸ í”„ë¡œì íŠ¸ëŠ” E-commerce í™˜ê²½ì„ ì¬í˜„í•˜ê¸° ìœ„í•´, Python ê¸°ë°˜ìœ¼ë¡œ **ì¬í˜„ ê°€ëŠ¥í•œ(Same seed)** synthetic datasetì„ ìƒì„±í•©ë‹ˆë‹¤.

### 4.1 Generation Principles (ì„¤ê³„ ì›ì¹™)
- **Raw ë¡œê·¸ ë³´ì¡´:** `sessions/events`ëŠ” ì›ì‹œ ë¡œê·¸ í˜•íƒœë¡œ ìœ ì§€í•˜ê³ ,  
  revisit/retention/funnel conversion/consistency ê°™ì€ íŒŒìƒ ì§€í‘œëŠ” **BigQuery Data Mart(SQL)**ì—ì„œ ê³„ì‚°í•©ë‹ˆë‹¤.
- **Funnel 5-step ê³ ì •:** `view â†’ click â†’ add_to_cart â†’ checkout â†’ purchase`
- **ì •í•©ì„± ê·œì¹™:** `order_id`ëŠ” purchase ì´ë²¤íŠ¸ì—ì„œë§Œ ìƒì„±ë˜ë©°,  
  **purchase ì´ë²¤íŠ¸ 1ê±´ = orders 1ê±´**ìœ¼ë¡œ ë§¤ì¹­ë©ë‹ˆë‹¤.
- **Promo ë°˜ì˜:** `promo_calendar` ê¸°ê°„ì— `sessions/events/orders`ì— í”„ë¡œëª¨ì…˜ ì†ì„±ì´ ì¼ê´€ë˜ê²Œ ë°˜ì˜ë©ë‹ˆë‹¤.
- **Subscription ë°˜ì˜:** ìœ ì €ë³„ ë©¤ë²„ì‹­ ê²°ê³¼(`subscriptions`)ë¥¼ ìƒì„±í•´ ì¥ê¸° ê°€ì¹˜ ë¹„êµ ë¶„ì„ì— í™œìš©í•©ë‹ˆë‹¤.

### 4.2 Dataset Scale (ì˜ˆì‹œ)
(ìƒì„± ì‹œì /íŒŒë¼ë¯¸í„°ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ)

- users â‰ˆ 30,000 / products = 300 / promo = 5  
- sessions â‰ˆ 0.75M / events â‰ˆ 1.8M  
- orders â‰ˆ 15k / order_items â‰ˆ 25k / subscriptions = 30,000

### 4.3 Reproducibility (ì¬í˜„ì„±)
- random seedë¥¼ ê³ ì •í•´ ë™ì¼ í™˜ê²½ì—ì„œ ë™ì¼í•œ ë°ì´í„° ìƒì„±ì´ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.
- ìƒì„± ë° ì •í•©ì„± ê²€ì¦(sanity check) ì´í›„ BigQuery ì ì¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

> Detailed generation rules (probabilities / decay / caps / schedules) are documented separately.  
> - `docs/generation_rules.md` (ì˜ˆì •)

ğŸ“ ê²½ë¡œ: `src/data_generation/`
```text
src/data_generation/
â”œâ”€â”€ generate_users.py
â”œâ”€â”€ generate_products.py
â”œâ”€â”€ generate_orders.py
â”œâ”€â”€ generate_order_items.py
â””â”€â”€ generate_events.py
```
---

# 5. ğŸ§± BigQuery Data Mart

ë¶„ì„ íš¨ìœ¨ì„ ìœ„í•´ BigQuery ê¸°ë°˜ Data Martë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.

### Data Mart í…Œì´ë¸”

#### **1) dm_user_purchase_summary**
- LTV  
- êµ¬ë§¤ íšŸìˆ˜ / ì²« êµ¬ë§¤ì¼  
- Subscriptionë³„ KPI  

#### **2) dm_category_performance**
- ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ  
- AOV  
- ì„±ì¥ë¥  & ì‹œì¦Œì„±  

#### **3) dm_funnel_events**
- ë‹¨ê³„ë³„ ì „í™˜ìœ¨  
- Drop-off ìœ„ì¹˜  
- session ë‹¨ìœ„ ì •ê·œí™” ì´ë²¤íŠ¸

### BigQuery ì¿¼ë¦¬ ìµœì í™”
- **Partition**: `orders.order_date`  
- **Clustering**: `user_events(user_id, event_type)`  

ğŸ“ SQL ì½”ë“œ: `src/sql/`

---

# 6. âš™ï¸ Airflow Workflow Automation

ë³¸ í”„ë¡œì íŠ¸ëŠ” ë°ì´í„° ìƒì„±ê³¼ Data Mart ì—…ë°ì´íŠ¸ ì‘ì—…ì„ ìë™í™”í•˜ê¸° ìœ„í•´ **Apache Airflow**ë¥¼ í™œìš©í–ˆìŠµë‹ˆë‹¤.

### êµ¬ì„± DAG

| DAG ì´ë¦„ | ì„¤ëª… |
|---------|------|
| **generate_synthetic_data_daily** | Pythonìœ¼ë¡œ Users/Products/Orders/Events ìƒì„± í›„ BigQuery ì ì¬ |
| **refresh_data_mart** | Data Mart(SQL View/Materialized Table) ì •ê¸° ì—…ë°ì´íŠ¸ |
| **funnel_preprocessing_dag** | user_events í…Œì´ë¸”ì„ session ë‹¨ìœ„ë¡œ ì „ì²˜ë¦¬í•œ í›„ dm_funnel_eventsë¡œ ë°˜ì˜ |

### Workflow êµ¬ì¡°

### ì‚¬ìš©ëœ Operators
- PythonOperator  
- BigQueryInsertJobOperator  
- Task dependency (`>>`)  
- Daily scheduling (`@daily`)

ğŸ“ DAG íŒŒì¼: `airflow/dags/`

---

# 7. ğŸ“Š SQL-Based Analysis

### ë¶„ì„ í•­ëª©
- Cohort & Retention  
- LTV & ì¬êµ¬ë§¤ íŒ¨í„´  
- Subscription íš¨ê³¼  
- Category ì„±ê³¼ ë¶„ì„  
- Funnel Drop-off ë¶„ì„  
- Behavior-based segmentation  

ğŸ“ SQL Notebook: `src/sql/`

---

# 8. ğŸ Python EDA & Statistical Analysis

### ë¶„ì„ í•­ëª©
- ë¶„í¬/ìƒê´€ê´€ê³„ EDA  
- Subscription êµ° ê°„ AOV ë¹„êµ (t-test, Mann-Whitney U)  
- Bootstrap ê¸°ë°˜ A/B Test  
- Retention Heatmap  
- Funnel ì´ë²¤íŠ¸ ìƒì„¸ ë¶„ì„  

ğŸ“ Notebook: `src/python/`

---

# 9. ğŸ“ˆ Tableau Dashboard

### Dashboard êµ¬ì„± (ì´ 4 pages)
1. KPI Overview  
2. Category Performance  
3. Cohort & Retention  
4. Funnel & Drop-off  

### Tableau ìë™ ì—…ë°ì´íŠ¸
- BigQuery Live Connection  
- Data Mart â†’ Tableau ì‹¤ì‹œê°„ ë°˜ì˜  

ğŸ“ Tableau íŒŒì¼: `tableau/`

---

# 10. ğŸ” Final Insights

ë¶„ì„ ê²°ê³¼ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1. ë†’ì€ LTV ê³ ê°êµ°ì˜ í–‰ë™ì  íŠ¹ì§• ë„ì¶œ  
2. Funnel ë‹¨ê³„ë³„ ì£¼ìš” ì´íƒˆ ìš”ì¸ ë° ê°œì„  ì „ëµ  
3. Discount Dayì˜ ì‹ ê·œ ê³ ê° ì „í™˜ íš¨ê³¼  
4. ì„±ì¥ vs ë¹„íš¨ìœ¨ ì¹´í…Œê³ ë¦¬ ì‹ë³„  
5. Retention ê°œì„ ì„ ìœ„í•œ Activation ì§€í‘œ ë°œêµ´  

---

# ğŸ§° Tech Stack

- **Python**: pandas, numpy, faker, matplotlib  
- **SQL**: BigQuery  
- **Airflow**: DAG Scheduling  
- **Visualization**: Tableau  
- **Infra**: GitHub  

---



